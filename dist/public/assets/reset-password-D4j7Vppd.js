import{u as R,a as I,r as t,j as e,A as l,C as p,b as j,c as B,L as m,B as x,d as F,e as N,I as y,E as P,f as b}from"./index-BzVmYWmQ.js";function q(){R();const{toast:n}=I(),[h,o]=t.useState(!1),[v,S]=t.useState(""),[a,k]=t.useState({newPassword:"",confirmPassword:""}),[i,C]=t.useState({newPassword:!1,confirmPassword:!1}),[w,d]=t.useState("pending"),[E,c]=t.useState("");t.useEffect(()=>{const s=new URLSearchParams(window.location.search).get("token");s?S(s):(d("error"),c("Invalid reset link. Please request a new password reset."))},[]);const L=async r=>{if(r.preventDefault(),o(!0),a.newPassword!==a.confirmPassword){n({variant:"destructive",title:"Error",description:"Passwords do not match"}),o(!1);return}if(a.newPassword.length<8){n({variant:"destructive",title:"Error",description:"Password must be at least 8 characters long"}),o(!1);return}try{const s=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:v,newPassword:a.newPassword})}),f=await s.json();s.ok?(d("success"),n({title:"Success",description:"Your password has been reset successfully!"})):(d("error"),c(f.message||"Failed to reset password"),n({variant:"destructive",title:"Error",description:f.message||"Failed to reset password"}))}catch{d("error"),c("Something went wrong. Please try again."),n({variant:"destructive",title:"Error",description:"Something went wrong. Please try again."})}finally{o(!1)}},u=r=>{k({...a,[r.target.name]:r.target.value})},g=r=>{C(s=>({...s,[r]:!s[r]}))};return w==="success"?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(l,{currentPage:""}),e.jsx("section",{className:"py-16",children:e.jsx("div",{className:"max-w-md mx-auto px-4 sm:px-6",children:e.jsx(p,{className:"text-center",children:e.jsxs(j,{className:"pt-6",children:[e.jsx("div",{className:"mx-auto w-16 h-16 flex items-center justify-center bg-green-100 rounded-full mb-4",children:e.jsx(B,{className:"w-8 h-8 text-green-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Password Reset Successful"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Your password has been updated successfully."}),e.jsx(m,{href:"/login",children:e.jsx(x,{className:"bg-finder-red hover:bg-finder-red-dark text-white",children:"Continue to Login"})})]})})})})]}):w==="error"?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(l,{currentPage:""}),e.jsx("section",{className:"py-16",children:e.jsx("div",{className:"max-w-md mx-auto px-4 sm:px-6",children:e.jsx(p,{className:"text-center",children:e.jsxs(j,{className:"pt-6",children:[e.jsx("div",{className:"mx-auto w-16 h-16 flex items-center justify-center bg-red-100 rounded-full mb-4",children:e.jsx(F,{className:"w-8 h-8 text-red-600"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Reset Link Invalid"}),e.jsx("p",{className:"text-gray-600 mb-6",children:E}),e.jsx(m,{href:"/login",children:e.jsx(x,{className:"bg-finder-red hover:bg-finder-red-dark text-white",children:"Back to Login"})})]})})})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(l,{currentPage:""}),e.jsx("section",{className:"py-8 sm:py-16",children:e.jsx("div",{className:"max-w-md mx-auto px-4 sm:px-6",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Reset Password"}),e.jsx("p",{className:"text-gray-600",children:"Enter your new password below"})]}),e.jsxs("form",{onSubmit:L,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(N,{htmlFor:"newPassword",className:"text-gray-700 font-medium",children:"New Password"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(y,{id:"newPassword",name:"newPassword",type:i.newPassword?"text":"password",required:!0,value:a.newPassword,onChange:u,className:"pr-12",placeholder:"Enter new password"}),e.jsx("button",{type:"button",onClick:()=>g("newPassword"),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-600",children:i.newPassword?e.jsx(P,{className:"w-5 h-5"}):e.jsx(b,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{children:[e.jsx(N,{htmlFor:"confirmPassword",className:"text-gray-700 font-medium",children:"Confirm New Password"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(y,{id:"confirmPassword",name:"confirmPassword",type:i.confirmPassword?"text":"password",required:!0,value:a.confirmPassword,onChange:u,className:"pr-12",placeholder:"Confirm new password"}),e.jsx("button",{type:"button",onClick:()=>g("confirmPassword"),className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-600",children:i.confirmPassword?e.jsx(P,{className:"w-5 h-5"}):e.jsx(b,{className:"w-5 h-5"})})]})]}),e.jsx(x,{type:"submit",className:"w-full bg-finder-red hover:bg-finder-red-dark text-white py-3 font-medium",disabled:h,children:h?"Resetting...":"Reset Password"})]}),e.jsx("div",{className:"text-center mt-6",children:e.jsx(m,{href:"/login",className:"text-sm text-gray-500 hover:text-finder-red",children:"Back to Login"})})]})})})]})}export{q as default};
